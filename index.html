<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cool Snake Game</title>
<style>
    body {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        margin: 0;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        font-family: 'Arial', sans-serif;
        color: white;
        overflow: hidden;
    }
    canvas {
        border: 3px solid #fff;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(0,0,0,0.5);
        background: radial-gradient(circle, #2c3e50 0%, #34495e 100%);
        max-width: 90vw;
        max-height: 70vh;
        aspect-ratio: 1;
        display: none; /* disembunyikan dulu sampai start */
    }
    .ui {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-bottom: 20px;
    }
    .score {
        font-size: 28px;
        font-weight: bold;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        display: none; /* tampil setelah start */
    }
    .controls {
        display: grid;
        grid-template-areas: 
            ". up ."
            "left . right"
            ". down .";
        grid-template-columns: 1fr 1fr 1fr;
        grid-template-rows: 1fr 1fr 1fr;
        gap: 15px;
        margin-top: 20px;
        justify-items: center;
        align-items: center;
        display: none; /* tampil setelah start */
    }
    button {
        width: 80px;
        height: 80px;
        font-size: 28px;
        background: rgba(255,255,255,0.2);
        color: white;
        border: 2px solid white;
        border-radius: 50%;
        cursor: pointer;
        transition: all 0.2s;
        backdrop-filter: blur(10px);
        display: flex;
        align-items: center;
        justify-content: center;
    }
    button:hover, button:active {
        background: rgba(255,255,255,0.4);
        transform: scale(1.05);
    }
    #up { grid-area: up; }
    #left { grid-area: left; }
    #down { grid-area: down; }
    #right { grid-area: right; }
    .pause-btn, .start-btn, .restart-btn {
        margin-top: 15px;
        width: auto;
        height: auto;
        padding: 12px 24px;
        border-radius: 25px;
        font-size: 18px;
        background: rgba(255,255,255,0.2);
        border: 2px solid white;
        color: white;
        cursor: pointer;
        transition: all 0.2s;
        backdrop-filter: blur(10px);
    }
    .pause-btn:hover, .start-btn:hover, .restart-btn:hover {
        background: rgba(255,255,255,0.4);
        transform: scale(1.05);
    }
    .restart-btn {
        display: none;
    }
    @media (max-width: 600px) {
        .controls {
            gap: 10px;
        }
        button {
            width: 70px;
            height: 70px;
            font-size: 24px;
        }
        .pause-btn {
            padding: 10px 20px;
            font-size: 16px;
        }
    }
    @media (min-width: 601px) {
        .controls {
            display: none; /* keyboard only di desktop */
        }
    }
</style>
</head>
<body>
    <div class="ui">
        <div class="score">Score: <span id="score">0</span> | High Score: <span id="highScore">0</span></div>
        <button class="pause-btn" id="pauseBtn" style="display:none;">Pause</button>
        <button class="start-btn" id="startBtn">Start Game</button>
        <button class="restart-btn" id="restartBtn">Restart</button>
    </div>
    <canvas id="gameCanvas" width="400" height="400"></canvas>
    <div class="controls">
        <button id="up">↑</button>
        <button id="left">←</button>
        <button id="down">↓</button>
        <button id="right">→</button>
    </div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const scoreElement = document.getElementById('score');
const highScoreElement = document.getElementById('highScore');
const pauseBtn = document.getElementById('pauseBtn');
const startBtn = document.getElementById('startBtn');
const restartBtn = document.getElementById('restartBtn');
const controls = document.querySelector('.controls');
const scoreUI = document.querySelector('.score');

const gridSize = 20;
let snake, direction, food, score, highScore, gameRunning, paused, speed, interval;

highScore = localStorage.getItem('snakeHighScore') || 0;
highScoreElement.textContent = highScore;

// Sound
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
function playSound(frequency, duration) {
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.frequency.value = frequency;
    gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
    osc.start();
    osc.stop(audioCtx.currentTime + duration);
}

function generateFood() {
    let newFood;
    do {
        newFood = {
            x: Math.floor(Math.random() * (canvas.width / gridSize)) * gridSize,
            y: Math.floor(Math.random() * (canvas.height / gridSize)) * gridSize
        };
    } while (snake.some(s => s.x === newFood.x && s.y === newFood.y));
    return newFood;
}

function drawSnake() {
    snake.forEach((segment, i) => {
        const grad = ctx.createLinearGradient(segment.x, segment.y, segment.x + gridSize, segment.y + gridSize);
        grad.addColorStop(0, i === 0 ? '#00ff00' : '#32cd32');
        grad.addColorStop(1, '#228b22');
        ctx.fillStyle = grad;
        ctx.fillRect(segment.x, segment.y, gridSize, gridSize);
        ctx.strokeStyle = '#fff';
        ctx.strokeRect(segment.x, segment.y, gridSize, gridSize);
    });
}
function drawFood() {
    ctx.fillStyle = '#ff4500';
    ctx.beginPath();
    ctx.arc(food.x + gridSize/2, food.y + gridSize/2, gridSize/2, 0, 2*Math.PI);
    ctx.fill();
    ctx.strokeStyle = '#fff';
    ctx.stroke();
}
function drawGrid() {
    ctx.strokeStyle = 'rgba(255,255,255,0.1)';
    for (let i = 0; i <= canvas.width; i += gridSize) {
        ctx.beginPath(); ctx.moveTo(i,0); ctx.lineTo(i,canvas.height); ctx.stroke();
    }
    for (let i = 0; i <= canvas.height; i += gridSize) {
        ctx.beginPath(); ctx.moveTo(0,i); ctx.lineTo(canvas.width,i); ctx.stroke();
    }
}
function draw() {
    ctx.clearRect(0,0,canvas.width,canvas.height);
    drawGrid(); drawSnake(); drawFood();
}

function moveSnake() {
    const head = {x: snake[0].x + direction.x, y: snake[0].y + direction.y};
    snake.unshift(head);

    if (head.x === food.x && head.y === food.y) {
        score++;
        scoreElement.textContent = score;
        playSound(800, 0.1);
        food = generateFood();
        if (score % 5 === 0) speed = Math.max(50, speed - 10);
        clearInterval(interval);
        interval = setInterval(gameLoop, speed);
    } else snake.pop();

    if (head.x < 0 || head.x >= canvas.width || head.y < 0 || head.y >= canvas.height || snake.slice(1).some(s => s.x===head.x && s.y===head.y)) {
        gameOver();
    }
}

function gameOver() {
    gameRunning = false;
    playSound(200, 0.5);
    clearInterval(interval);
    if (score > highScore) {
        highScore = score;
        localStorage.setItem('snakeHighScore', highScore);
        highScoreElement.textContent = highScore;
    }
    ctx.fillStyle = 'rgba(0,0,0,0.7)';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle = 'white';
    ctx.font = 'bold 30px Arial';
    ctx.textAlign = 'center';
    ctx.fillText('Game Over', canvas.width/2, canvas.height/2 - 10);
    restartBtn.style.display = 'block';
}

function startGame() {
    snake = [{x:200,y:200}];
    direction = {x:0,y:0};
    food = generateFood();
    score = 0;
    speed = 150;
    paused = false;
    gameRunning = true;

    startBtn.style.display = 'none';
    restartBtn.style.display = 'none';
    canvas.style.display = 'block';
    scoreUI.style.display = 'block';
    pauseBtn.style.display = 'inline-block';
    controls.style.display = 'grid';

    interval = setInterval(gameLoop, speed);
}

function gameLoop() {
    if (gameRunning && !paused) {
        moveSnake(); draw();
    }
}

// Keyboard controls
document.addEventListener('keydown', e => {
    if (!gameRunning || paused) return;
    switch (e.key) {
        case 'ArrowUp': if (direction.y === 0) direction = {x:0,y:-gridSize}; break;
        case 'ArrowDown': if (direction.y === 0) direction = {x:0,y:gridSize}; break;
        case 'ArrowLeft': if (direction.x === 0) direction = {x:-gridSize,y:0}; break;
        case 'ArrowRight': if (direction.x === 0) direction = {x:gridSize,y:0}; break;
    }
});

pauseBtn.addEventListener('click', () => {
    if (!gameRunning) return;
    paused = !paused;
    pauseBtn.textContent = paused ? 'Resume' : 'Pause';
});
startBtn.addEventListener('click', startGame);
restartBtn.addEventListener('click', startGame);

// Mobile controls
document.getElementById('up').onclick = ()=>{ if(direction.y===0) direction={x:0,y:-gridSize}; };
document.getElementById('down').onclick = ()=>{ if(direction.y===0) direction={x:0,y:gridSize}; };
document.getElementById('left').onclick = ()=>{ if(direction.x===0) direction={x:-gridSize,y:0}; };
document.getElementById('right').onclick = ()=>{ if(direction.x===0) direction={x:gridSize,y:0}; };
</script>
</body>
</html>
